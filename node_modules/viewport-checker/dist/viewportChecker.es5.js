/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var t=function(){return(t=Object.assign||function(t){for(var e,o=1,i=arguments.length;o<i;o++)for(var s in e=arguments[o])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)},e=function(){function e(e,o){this.query=e,this.boxSize={height:0,width:0},this.options=t({classToAdd:"visible",classToRemove:"invisible",classToAddForFullView:"full-visible",removeClassAfterAnimation:!1,offset:100,repeat:!1,invertBottomOffset:!0,callbackFunction:function(){},scrollHorizontal:!1,scrollBox:window},o)}return e.prototype.handleEvent=function(t){switch(t.type){case"scroll":this.check();break;case"resize":this.recalculateBoxsize(),this.check()}},e.prototype.attach=function(){(this.elements=document.querySelectorAll(this.query),this.recalculateBoxsize(),this._registerIndex=o(this),this.options.scrollBox instanceof Window)||this.resolveScrollBox().addEventListener("scroll",this);this.check()},e.prototype.detach=function(){this._registerIndex&&(i(this._registerIndex),this._registerIndex=void 0,this.options.scrollBox instanceof Window||this.resolveScrollBox().removeEventListener("scroll",this))},e.prototype.resolveScrollBox=function(){if(this.options.scrollBox instanceof Window)return this.options.scrollBox;var t=document.querySelector(this.options.scrollBox);if(!t)throw new Error(this.options.scrollBox+" does not resolve to an existing DOM Element");return t},e.prototype.recalculateBoxsize=function(){this.boxSize=this.getBoxSize()},e.prototype.check=function(){var e,o=this,i=0,s=0;this.options.scrollHorizontal?(i=Math.max(document.body.scrollLeft,document.documentElement.scrollLeft,window.scrollX),s=i+this.boxSize.width):(i=Math.max(document.body.scrollTop,document.documentElement.scrollTop,window.scrollY),s=i+this.boxSize.height),null===(e=this.elements)||void 0===e||e.forEach((function(e){var n,r,l,c,a,d,p=t({},o.options),h={classToAdd:"vpAddClass",classToRemove:"vpRemoveClass",classToAddForFullView:"vpAddClassFullView",removeClassAfterAnimation:"vpKeepAddClass",offset:"vpOffset",repeat:"vpRepeat",scrollHorizontal:"vpScrollHorizontal",invertBottomOffset:"vpInvertBottomOffset"};for(var f in h){var u=h[f],v=e.dataset[u];v&&(p[f]=v)}if(!e.dataset.vpAnimated||p.repeat){var m;if("string"==typeof p.offset)m=p.offset.includes("%")?parseInt(p.offset)/100*o.boxSize.height:parseInt(p.offset);else{if("number"!=typeof p.offset)throw new Error("Provided objOffet '"+p.offset+"' can't be parsed. Provide a percentage or absolute number");m=p.offset}var w=p.scrollHorizontal?e.getBoundingClientRect().left:e.getBoundingClientRect().top,E=w+(p.scrollHorizontal?e.clientWidth:e.clientHeight),x=Math.round(w)+m,C=x+(p.scrollHorizontal?e.clientWidth:e.clientHeight);p.invertBottomOffset&&(C-=2*m),x<s&&C>i?((n=e.classList).remove.apply(n,p.classToRemove.split(" ")),(r=e.classList).add.apply(r,p.classToAdd.split(" ")),p.callbackFunction(e,"add"),E<=s&&w>=i?(l=e.classList).add.apply(l,p.classToAddForFullView.split(" ")):(c=e.classList).remove.apply(c,p.classToAddForFullView.split(" ")),e.dataset.vpAnimated="true",p.removeClassAfterAnimation&&e.addEventListener("animationend",(function(){var t;return(t=e.classList).remove.apply(t,p.classToAdd.split(" "))}),{once:!0})):p.repeat&&p.classToAdd.split(" ").reduce((function(t,o){return t||e.classList.contains(o)}),!1)&&((a=e.classList).remove.apply(a,p.classToAdd.split(" ")),(d=e.classList).remove.apply(d,p.classToAddForFullView.split(" ")),p.callbackFunction(e,"remove"),e.dataset.vpAnimated=void 0)}}))},e.prototype.getBoxSize=function(){var t=this.resolveScrollBox();return t instanceof Window?{height:t.innerHeight,width:t.innerWidth}:{height:t.clientHeight,width:t.clientWidth}},e}(),o=function(t){return window._VP_CHECKERS=window._VP_CHECKERS||[],window._VP_CHECKERS.push(t)},i=function(t){window._VP_CHECKERS=window._VP_CHECKERS||[],window._VP_CHECKERS[t]&&window._VP_CHECKERS.splice(t,1)};!function(t,e){var o=function(){(t._VP_CHECKERS||[]).forEach((function(t){return t.check()}))};("ontouchstart"in t||"onmsgesturechange"in t)&&["touchmove","MSPointerMove","pointermove"].forEach((function(t){return e.addEventListener(t,o)})),t.addEventListener("load",o,{once:!0}),t.addEventListener("resize",(function(){(t._VP_CHECKERS||[]).forEach((function(t){return t.recalculateBoxsize()})),o()}))}(window,document);export default e;
//# sourceMappingURL=viewportChecker.es5.js.map
